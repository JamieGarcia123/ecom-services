var N=Object.defineProperty;var L=(l,r,s)=>r in l?N(l,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[r]=s;var u=(l,r,s)=>L(l,typeof r!="symbol"?r+"":r,s);import{w as C,a as d,p as e}from"./chunk-EF7DTUVF-DFp-VzBN.js";import{s as n}from"./supabaseDataManager-CPgVSS-r.js";class F{constructor(){u(this,"services",[]);u(this,"categories",[]);u(this,"providers",[]);u(this,"initialized",!1)}async initialize(){if(!this.initialized)try{const[r,s,i]=await Promise.all([fetch("/data/services.json"),fetch("/data/categories.json"),fetch("/data/providers.json")]);this.services=await r.json(),this.categories=await s.json(),this.providers=await i.json(),this.initialized=!0,console.log(`Loaded ${this.services.length} services, ${this.categories.length} categories, ${this.providers.length} providers`)}catch(r){console.error("Error loading JSON data:",r),this.services=[],this.categories=[],this.providers=[]}}getAllServices(){return this.services.filter(r=>r.active!==!1)}getServiceById(r){return this.services.find(s=>s.id===r&&s.active!==!1)}getServicesByCategory(r){return this.services.filter(s=>s.category===r&&s.active!==!1)}getServicesByProvider(r){return this.services.filter(s=>s.provider===r&&s.active!==!1)}searchServices(r){const s=r.toLowerCase();return this.services.filter(i=>{var o;return i.active!==!1&&(i.name.toLowerCase().includes(s)||i.description.toLowerCase().includes(s)||((o=i.category)==null?void 0:o.toLowerCase().includes(s)))})}addService(r){const s={...r,id:Math.max(...this.services.map(i=>i.id),0)+1,active:!0};return console.log("addService - adding new service:",s.name,"with ID:",s.id),console.log("addService - current services count before add:",this.services.length),this.services.push(s),console.log("addService - services count after add:",this.services.length),this.saveToLocalStorage(),this.loadFromLocalStorage(),console.log("addService - final services count after localStorage reload:",this.services.length),s}updateService(r,s){const i=this.services.findIndex(o=>o.id===r);return i===-1?null:(this.services[i]={...this.services[i],...s},this.saveToLocalStorage(),this.services[i])}deleteService(r){const s=this.services.findIndex(i=>i.id===r);return s===-1?!1:(this.services[s].active=!1,this.saveToLocalStorage(),!0)}getAllCategories(){return this.categories}getCategoryById(r){return this.categories.find(s=>s.id===r)}getAllProviders(){return this.providers}getProviderById(r){return this.providers.find(s=>s.id===r)}getProviderByEmail(r){return this.providers.find(s=>s.email===r)}saveToLocalStorage(){if(typeof window<"u")try{const r=[1,2,3,4,5,6,7],s=this.services.filter(i=>!r.includes(i.id));console.log("saveToLocalStorage - saving",s.length,"new services to localStorage"),console.log("saveToLocalStorage - new services:",s.map(i=>({id:i.id,name:i.name}))),localStorage.setItem("services_data",JSON.stringify(s)),console.log("Services saved to localStorage")}catch(r){console.error("Error saving to localStorage:",r)}}loadFromLocalStorage(){if(typeof window<"u")try{const r=localStorage.getItem("services_data");if(r){const s=JSON.parse(r);console.log("loadFromLocalStorage - found",s.length,"services in localStorage"),console.log("loadFromLocalStorage - current services count before merge:",this.services.length),s.forEach(i=>{const o=this.services.findIndex(v=>v.id===i.id);o>=0?(console.log("loadFromLocalStorage - updating existing service:",i.name),this.services[o]=i):(console.log("loadFromLocalStorage - adding new service:",i.name),this.services.push(i))}),console.log("loadFromLocalStorage - services count after merge:",this.services.length),console.log("Services loaded from localStorage")}else console.log("loadFromLocalStorage - no localStorage data found")}catch(r){console.error("Error loading from localStorage:",r)}}exportData(){return{services:this.services,categories:this.categories,providers:this.providers,exportDate:new Date().toISOString()}}}const h=new F;let x=null;async function y(){return x||(x=h.initialize().then(()=>{h.loadFromLocalStorage()})),x}async function D(){return await y(),h.getAllCategories()}async function k(){return await y(),h.getAllProviders()}const R=C(function(){const[r,s]=d.useState([]),[i,o]=d.useState([]),[v,S]=d.useState(!0),[p,c]=d.useState(null),[b,g]=d.useState(!1),j=async a=>{if(a.preventDefault(),g(!0),c(null),!n.isConfigured()){c("Service addition requires Supabase configuration. Please set up your environment variables or use a platform with backend support."),g(!1);return}try{const t=new FormData(a.currentTarget),m=parseFloat(t.get("price")),f=t.get("duration");if(isNaN(m)||m<=0){c("Please enter a valid price greater than $0.00"),g(!1);return}if(f&&!f.toLowerCase().match(/(minute|hour|min|hr)/)){c("Duration must include time units (e.g., '60 minutes', '1 hour', '90 mins')"),g(!1);return}const w={name:t.get("name"),description:t.get("description"),price:Math.round(m*100)/100,category:t.get("category"),provider:t.get("provider"),duration:f||void 0,image:t.get("image")||void 0};await n.addService(w)?window.location.href="/services":c("Failed to add service. Please try again.")}catch(t){console.error("Error adding service:",t),c("Error adding service: "+t.message)}finally{g(!1)}};return d.useEffect(()=>{async function a(){try{const[t,m]=await Promise.all([D(),k()]);s(t),o(m)}catch(t){console.error("Error loading form data:",t)}finally{S(!1)}}a()},[]),v?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading form data..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Add New Service"}),e.jsx("p",{className:"text-gray-600",children:"Create a new holistic service offering"})]}),n.isConfigured()?e.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-green-700",children:[e.jsx("strong",{children:"Database Connected:"})," Supabase is configured. You can add new services to the database."]})})]})}):e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsx("strong",{children:"Setup Required:"})," To enable service addition, please set up Supabase (free database). See ",e.jsx("strong",{children:"SUPABASE_SETUP.md"})," for instructions. Without Supabase, this is a static demo only."]})})]})}),e.jsxs("div",{className:`bg-white shadow-md rounded-lg p-6 ${n.isConfigured()?"":"opacity-75"}`,children:[e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[p&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:p})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Service Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Advanced Reiki Healing"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("textarea",{id:"description",name:"description",rows:4,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Detailed description of the service..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"Price ($) *"}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0.01",step:"0.01",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"75.00",title:"Enter price in format: 75.00"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Format: 00.00 (e.g., 75.00)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"Duration"}),e.jsx("input",{type:"text",id:"duration",name:"duration",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"60 minutes",title:"Include time units: minutes, hours, mins, hrs"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:'Include time units (e.g., "60 minutes", "1 hour")'})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700",children:"Category"}),e.jsxs("select",{id:"category",name:"category",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Select a category"}),r.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"provider",className:"block text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs("select",{id:"provider",name:"provider",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Select a provider"}),i.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image",className:"block text-sm font-medium text-gray-700",children:"Image URL"}),e.jsx("input",{type:"url",id:"image",name:"image",className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"/images/service-name.jpg"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Optional: URL to service image (relative or absolute)"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("button",{type:"submit",disabled:b||!n.isConfigured(),className:`w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-white font-medium ${n.isConfigured()?"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed":"bg-gray-400 cursor-not-allowed"}`,children:b?"Adding Service...":n.isConfigured()?"Add Service":"Add Service (Setup Supabase First)"}),!n.isConfigured()&&e.jsx("p",{className:"mt-2 text-sm text-gray-500 text-center",children:"Configure Supabase to enable service addition"})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("a",{href:"/services",className:"text-green-600 hover:text-green-500 text-sm font-medium",children:"← Back to Services"}),e.jsx("a",{href:"/provider-dashboard",className:"text-green-600 hover:text-green-500 text-sm font-medium",children:"Provider Dashboard"})]})})]})]})})});export{R as default};
